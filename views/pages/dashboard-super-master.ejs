<!DOCTYPE html>
<html lang="en">

<head>


        <!-- CSS -->
        <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.19/css/dataTables.bootstrap.min.css">

        <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>
        <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.19/js/dataTables.bootstrap.min.js"></script>
</head>

<body>
  <header class="theme-main-header" style="background-color: rgba(19, 35, 47, 0.9);">
        <div class="container">
          <a href="/" class="logo float-left tran4s"><h3 style="color: white;">Xverify</h3></a>


          <!-- ========================= Theme Feature Page Menu ======================= -->
          <nav class="navbar float-right theme-main-menu one-page-menu">
             <!-- Brand and toggle get grouped for better mobile display -->
             <div class="navbar-header">
               <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse-1" aria-expanded="false">
                 <span class="sr-only">Toggle navigation</span>
                 Menu
                 <i class="fa fa-bars" aria-hidden="true"></i>
               </button>
             </div>
             <!-- Collect the nav links, forms, and other content for toggling -->
             <div class="collapse navbar-collapse" id="navbar-collapse-1">
               <ul class="nav navbar-nav">


            <% if (!user) { %>

     <li><a class="dropdown-toggle" data-toggle="dropdown" href="#" style="background-color: #000000;">Login</a>
        <ul class="dropdown-menu" style="background-color: #000000;">
          <li><a href="/login">Login</a></li>
        </ul>
      </li>

     <% } else { %>

      <!-- <li><a class="dropdown-toggle" data-toggle="dropdown" href="#"><%= user.Company_name %></a>
        <ul class="dropdown-menu" style="background-color: #000000;"> -->
          <!-- <li><a href="/profile">Profile</a></li> -->
          <li><a href="/logout">Logout</a></li>
        <!-- </ul>
      </li> -->
      <% } %>

               </ul>
             </div><!-- /.navbar-collapse -->
          </nav> <!-- /.theme-feature-menu -->
        </div>
      </header>


        <div class="container">
            <div class="row" style="margin-top: 100px;">

                <div class="col-md-8">
                    <form class="form-horizontal">
                        <div class="form-group">
                            <label for="inputEmail3" class="col-sm-2 control-label">Email</label>
                            <div class="col-sm-10">
                                <select class="form-control" id="selectUser">
                                    <% if (users.length > 0) { %>
                                        <% users.forEach(function(user){ %>
                                            <option value="<%= user._id %>">
                                                <%= user.Company_name %>
                                            </option>
                                            <% }); %>
                                                <% } else { %>
                                                    <option value="">No users</option>
                                                    <% } %>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="col-sm-offset-2 col-sm-10">
                                <button type="submit" id="getReportbtn" class="btn btn-primary">Get count</button>
                            </div>
                        </div>
                    </form>

                </div>
                <div class="col-md-3 ">
                      <a href="/master-admin-signup"><button class="btn  btn-lg btn-primary">Company Signup</button></a>
                      <!-- <a href="/logout"><button   class="btn  btn-lg btn-primary"  />LOGOUT</button></a> -->
            </div>
            </div>

            <div class="row">
                <div class="col-md-12">
                    <div id="historyReport"></div>
                </div>
            </div>


        </div>
        <script src="/js/jquery.noty.packaged.min.js"></script>
        <script type="text/javascript">
            function generate(type, text) {
                var n = noty({
                    text: text,
                    type: type,
                    dismissQueue: true,
                    layout: 'topRight',
                    closeWith: ['click'],
                    theme: 'relax',
                    maxVisible: 10,
                    animation: {
                        open: 'animated bounceInRight',
                        close: 'animated bounceOutRight',
                        easing: 'swing',
                        speed: 500
                    }
                });
            }
            $(document).ready(function () {
                $('#getReportbtn').on('click', function (e) {
                    e.preventDefault();
                    $.ajax({
                        url: '/admin/get-companies-report',
                        data: {
                            _id: $("#selectUser").val()
                        },
                        error: function (jqXHR, exception) {
                            var errorObj = JSON.parse(jqXHR.responseText);
                            if (!errorObj.process) {
                                $("#pan1").hide();
                            }
                            var messageDiv =
                                '<div class="activity-item"><div class="activity">' +
                                errorObj.message + '</div> </div>';
                            generate("error", messageDiv);
                        },
                        dataType: 'json',
                        success: function (data) {
                            var table = '';
                            if (data.result !== null) {
                                table +=
                                    "<table id='example' class='table table-striped table-bordered'>";
                                table +=
                                    "<thead><tr><th>Name</th><th>Position</th></tr></thead><tbody>";
                                Object.keys(data.result).forEach(function (key) {
                                    table += "<tr><td>" + key + "</td><td>" + data.result[
                                        key] + "</td></tr>";
                                });
                                table += "</tbody></table>";
                            } else {
                                table += "<p>No History</p>";
                            }

                            $("#historyReport").html(table);
                        },
                        type: 'GET'
                    });
                });
            });
        </script>
</body>

</html>
